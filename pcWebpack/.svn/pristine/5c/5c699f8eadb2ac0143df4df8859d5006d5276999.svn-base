<template>
  <div class="d-height-100">
    <div class="d-login">
      <div class="wrap">
        <div class="d-login-bg">&nbsp;</div>
        <div class="content">
          <h3>
            <img src="../../static/Images/logo/logo_login.png" alt="登录图片" class="d-login-logo" />
          </h3>
          <div>
            <div class="d-warning">
              <p class="warning" v-cloak>
                <span v-show="isComplete">{{warningText}}</span>
              </p>
            </div>
            <div class="d-input">
              <label for="loginusername">
                <i class="iconfont icon-login-user"></i>
              </label>
              <input
                placeholder="用户名"
                @keyup.enter="next(1)"
                type="text"
                id="loginusername"
                v-model="loginusername"
              />
            </div>
            <div class="d-input">
              <label for="loginpassword">
                <i class="iconfont icon-login-pwd"></i>
              </label>
              <input
                placeholder="密码"
                @keyup.enter="next(2)"
                type="password"
                id="loginpassword"
                v-model="loginpassword"
              />
            </div>

            <div class="d-input">
              <div class="assign" @click="login">登录</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template> 

<script>

export default {
  name: "login",
  data() {
    return {
      loginusername: 'LHB',
      loginpassword: 'LHB',
      warningText: "",
      isComplete: false
    };
  },
  methods: {
    login: function() {
      var that = this;
      sessionStorage.setItem("styleType", 1); //设置默认样式为1
      jsTools.initConfig(phAjax);

      if (!this.loginusername) {
        this.isComplete = true;
        this.warningText = "请输入用户名";
        return;
      } else if (!this.loginpassword) {
        this.isComplete = true;
        this.warningText = "请输入密码";
        return;
      }
      //登录
       //that.$router.push('main');
      phAjax.logOn(
        this.loginusername,
        this.loginpassword,
        (xmlHttpRequest) => {
          if (xmlHttpRequest.status === 200) {
            jsTools.SessionStorage.setVal(
              jsTools.Res.userNumber,
              that.loginusername
            );
            that.$router.push('layout');
          } else {
            that.$router.push('layout');
            // jsTools.onErrorFunc(xmlHttpRequest);
          }
        }
      );
    },
    next: function(num) {
      if (num == 1) {
        $("#loginpassword").focus();
        return;
      }
      this.login();
    }
  }
};
</script>

<style>

  html,body,#app{
    height: 100%;
  }
</style>>



